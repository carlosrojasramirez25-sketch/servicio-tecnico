---
// Hero Section Component
const slides = [
  {
    title: "SERVICIO T√âCNICO",
    subtitle: "ESPECIALIZADO",
    description: "ELECTRODOM√âSTICOS GAMA",
    image: "/services/quitaaire.webp",
    cta: "üìû ¬°Escribenos ahora! 644259970",
    href: "tel:+34912345678"
  },
  {
    title: "REPARACI√ìN R√ÅPIDA",
    subtitle: "Y GARANTIZADA",
    description: "SOLUCIONES EN MENOS DE 24 HORAS",
    image: "/services/garantizadas.webp",
    cta: " Contactar por WhatsApp",
    href: "https://wa.me/34644259979"
  },
  {
    title: "MANTENIMIENTO",
    subtitle: "PREVENTIVO",
    description: "ALARGUE LA VIDA DE SUS EQUIPOS",
    image: "/services/preventivo.jpg",
    cta: " Solicitar Presupuesto",
    href: "#contacto"
  }
];
---

<section
  id="inicio"
  class="relative h-[90vh] md:min-h-screen flex items-center justify-center overflow-hidden pt-20"
>
  <!-- Carousel Slides -->
  <div class="absolute inset-0 z-0" id="carousel-container">
    {slides.map((slide, index) => (
      <div 
        class={`carousel-slide absolute inset-0 transition-opacity duration-1000 ease-in-out ${index === 0 ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}
        data-index={index}
      >
        <div class="absolute inset-0 bg-linear-to-r from-purple-900/95 via-purple-800/90 to-purple-700/85 z-10"></div>
        <img
          src={slide.image}
          alt={slide.title}
          class="w-full h-full object-cover"
          loading={index === 0 ? "eager" : "lazy"}
        />
        
        <!-- Content within Slide -->
        <div class="absolute inset-0 flex items-center justify-center z-20 text-center px-4">
          <div class="flex flex-col items-center gap-4 max-w-4xl">
            <div>
              <h1
                class="text-4xl md:text-6xl font-bold text-white mb-6 leading-tight animate-fade-in"
              >
                {slide.title}<br />
                <span
                  class="text-5xl md:text-7xl bg-linear-to-r from-purple-200 to-white bg-clip-text text-transparent"
                >
                  {slide.subtitle}
                </span>
              </h1>
              <p class="text-xl md:text-2xl text-purple-100 font-light">
                {slide.description}
              </p>
            </div>
            
            <a
              href={slide.href}
              class="inline-block bg-white text-purple-700 px-8 py-4 rounded-full font-bold text-lg hover:bg-purple-50 transition-all duration-300 shadow-2xl hover:shadow-purple-500/50 hover:scale-105 transform"
            >
              {slide.cta}
            </a>
          </div>
        </div>
      </div>
    ))}
  </div>

  <!-- Navigation Arrows -->
  <div class="absolute inset-0 z-30 flex items-center justify-between px-4 pointer-events-none">
    <button
      id="prev-slide"
      class="pointer-events-auto p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-all duration-300 group"
      aria-label="Previous slide"
    >
      <svg class="w-8 h-8 transform group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
    </button>
    <button
      id="next-slide"
      class="pointer-events-auto p-3 rounded-full bg-white/10 hover:bg-white/20 text-white transition-all duration-300 group"
      aria-label="Next slide"
    >
      <svg class="w-8 h-8 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </button>
  </div>

  <!-- Indicators -->
  <div class="absolute bottom-12 left-1/2 transform -translate-x-1/2 z-30 flex gap-3">
    {slides.map((_, index) => (
      <button
        class={`carousel-indicator w-3 h-3 rounded-full transition-all duration-300 ${index === 0 ? 'bg-white w-8' : 'bg-white/40'}`}
        data-index={index}
        aria-label={`Go to slide ${index + 1}`}
      ></button>
    ))}
  </div>

  <!-- Scroll Indicator -->
  <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 z-20 hidden md:block">
    <a
      href="#servicios"
      class="flex flex-col items-center text-white hover:text-purple-200 transition-colors"
    >
      <svg
        class="w-6 h-6 animate-bounce"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
      </svg>
    </a>
  </div>
</section>

<script>
  function setupCarousel() {
    const slides = document.querySelectorAll('.carousel-slide');
    const indicators = document.querySelectorAll('.carousel-indicator');
    const prevBtn = document.getElementById('prev-slide');
    const nextBtn = document.getElementById('next-slide');
    
    let currentIndex = 0;
    const intervalTime = 5000;
    let slideInterval:any;

    function showSlide(index:any) {
      slides.forEach((slide, i) => {
        if (i === index) {
          slide.classList.remove('opacity-0', 'pointer-events-none');
          slide.classList.add('opacity-100');
        } else {
          slide.classList.add('opacity-0', 'pointer-events-none');
          slide.classList.remove('opacity-100');
        }
      });

      indicators.forEach((indicator, i) => {
        if (i === index) {
          indicator.classList.remove('bg-white/40');
          indicator.classList.add('bg-white', 'w-8');
        } else {
          indicator.classList.add('bg-white/40');
          indicator.classList.remove('bg-white', 'w-8');
        }
      });

      currentIndex = index;
    }

    function nextSlide() {
      const next = (currentIndex + 1) % slides.length;
      showSlide(next);
    }

    function prevSlide() {
      const prev = (currentIndex - 1 + slides.length) % slides.length;
      showSlide(prev);
    }

    function startInterval() {
      slideInterval = setInterval(nextSlide, intervalTime);
    }

    function resetInterval() {
      clearInterval(slideInterval);
      startInterval();
    }

    indicators.forEach((indicator, index) => {
      indicator.addEventListener('click', () => {
        showSlide(index);
        resetInterval();
      });
    });

    if (prevBtn) {
      prevBtn.addEventListener('click', () => {
        prevSlide();
        resetInterval();
      });
    }

    if (nextBtn) {
      nextBtn.addEventListener('click', () => {
        nextSlide();
        resetInterval();
      });
    }

    startInterval();
  }

  // Support for Astro View Transitions
  document.addEventListener('astro:page-load', setupCarousel);
  // Initial setup
  setupCarousel();
</script>

<style>
  .animate-fade-in {
    animation: fadeIn 1s ease-out forwards;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Ensure slides occupy full height */
  .carousel-slide {
    height: 100%;
    width: 100%;
  }
</style>
